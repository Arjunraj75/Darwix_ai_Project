.PHONY: dev-up dev-down logs clean ingest-data process-data

dev-up:
	@echo "Building and starting services..."
	docker-compose up -d --build
	@echo "Waiting for database to be ready..."
	@sleep 5
	@echo "Running database migrations..."
	docker-compose exec api alembic upgrade head
	@echo " Services are up and running! API at http://localhost:9000"

dev-down:
	@echo "Stopping services..."
	docker-compose down

logs:
	@echo "Tailing logs for all services..."
	docker-compose logs -f

clean:
	@echo "Stopping and removing all containers, networks, and volumes..."
	docker-compose down -v --remove-orphans

ingest-data:
	@echo "Running data ingestion script..."
	docker-compose run --rm api python ingest_data.py

process-data:
	@echo "Running AI processing script..."
	docker-compose run --rm api python process_data.py